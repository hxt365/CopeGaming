{"ast":null,"code":"import { getWindow } from 'ssr-window';\nimport $ from '../../shared/dom.js';\nimport { getTranslate } from '../../shared/utils.js';\nexport default function Zoom(_ref) {\n  let {\n    swiper,\n    extendParams,\n    on,\n    emit\n  } = _ref;\n  const window = getWindow();\n  extendParams({\n    zoom: {\n      enabled: false,\n      maxRatio: 3,\n      minRatio: 1,\n      toggle: true,\n      containerClass: 'swiper-zoom-container',\n      zoomedSlideClass: 'swiper-slide-zoomed'\n    }\n  });\n  swiper.zoom = {\n    enabled: false\n  };\n  let currentScale = 1;\n  let isScaling = false;\n  let gesturesEnabled;\n  let fakeGestureTouched;\n  let fakeGestureMoved;\n  const gesture = {\n    $slideEl: undefined,\n    slideWidth: undefined,\n    slideHeight: undefined,\n    $imageEl: undefined,\n    $imageWrapEl: undefined,\n    maxRatio: 3\n  };\n  const image = {\n    isTouched: undefined,\n    isMoved: undefined,\n    currentX: undefined,\n    currentY: undefined,\n    minX: undefined,\n    minY: undefined,\n    maxX: undefined,\n    maxY: undefined,\n    width: undefined,\n    height: undefined,\n    startX: undefined,\n    startY: undefined,\n    touchesStart: {},\n    touchesCurrent: {}\n  };\n  const velocity = {\n    x: undefined,\n    y: undefined,\n    prevPositionX: undefined,\n    prevPositionY: undefined,\n    prevTime: undefined\n  };\n  let scale = 1;\n  Object.defineProperty(swiper.zoom, 'scale', {\n    get() {\n      return scale;\n    },\n\n    set(value) {\n      if (scale !== value) {\n        const imageEl = gesture.$imageEl ? gesture.$imageEl[0] : undefined;\n        const slideEl = gesture.$slideEl ? gesture.$slideEl[0] : undefined;\n        emit('zoomChange', value, imageEl, slideEl);\n      }\n\n      scale = value;\n    }\n\n  });\n\n  function getDistanceBetweenTouches(e) {\n    if (e.targetTouches.length < 2) return 1;\n    const x1 = e.targetTouches[0].pageX;\n    const y1 = e.targetTouches[0].pageY;\n    const x2 = e.targetTouches[1].pageX;\n    const y2 = e.targetTouches[1].pageY;\n    const distance = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n    return distance;\n  } // Events\n\n\n  function onGestureStart(e) {\n    const support = swiper.support;\n    const params = swiper.params.zoom;\n    fakeGestureTouched = false;\n    fakeGestureMoved = false;\n\n    if (!support.gestures) {\n      if (e.type !== 'touchstart' || e.type === 'touchstart' && e.targetTouches.length < 2) {\n        return;\n      }\n\n      fakeGestureTouched = true;\n      gesture.scaleStart = getDistanceBetweenTouches(e);\n    }\n\n    if (!gesture.$slideEl || !gesture.$slideEl.length) {\n      gesture.$slideEl = $(e.target).closest(`.${swiper.params.slideClass}`);\n      if (gesture.$slideEl.length === 0) gesture.$slideEl = swiper.slides.eq(swiper.activeIndex);\n      gesture.$imageEl = gesture.$slideEl.find(`.${params.containerClass}`).eq(0).find('picture, img, svg, canvas, .swiper-zoom-target').eq(0);\n      gesture.$imageWrapEl = gesture.$imageEl.parent(`.${params.containerClass}`);\n      gesture.maxRatio = gesture.$imageWrapEl.attr('data-swiper-zoom') || params.maxRatio;\n\n      if (gesture.$imageWrapEl.length === 0) {\n        gesture.$imageEl = undefined;\n        return;\n      }\n    }\n\n    if (gesture.$imageEl) {\n      gesture.$imageEl.transition(0);\n    }\n\n    isScaling = true;\n  }\n\n  function onGestureChange(e) {\n    const support = swiper.support;\n    const params = swiper.params.zoom;\n    const zoom = swiper.zoom;\n\n    if (!support.gestures) {\n      if (e.type !== 'touchmove' || e.type === 'touchmove' && e.targetTouches.length < 2) {\n        return;\n      }\n\n      fakeGestureMoved = true;\n      gesture.scaleMove = getDistanceBetweenTouches(e);\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) {\n      if (e.type === 'gesturechange') onGestureStart(e);\n      return;\n    }\n\n    if (support.gestures) {\n      zoom.scale = e.scale * currentScale;\n    } else {\n      zoom.scale = gesture.scaleMove / gesture.scaleStart * currentScale;\n    }\n\n    if (zoom.scale > gesture.maxRatio) {\n      zoom.scale = gesture.maxRatio - 1 + (zoom.scale - gesture.maxRatio + 1) ** 0.5;\n    }\n\n    if (zoom.scale < params.minRatio) {\n      zoom.scale = params.minRatio + 1 - (params.minRatio - zoom.scale + 1) ** 0.5;\n    }\n\n    gesture.$imageEl.transform(`translate3d(0,0,0) scale(${zoom.scale})`);\n  }\n\n  function onGestureEnd(e) {\n    const device = swiper.device;\n    const support = swiper.support;\n    const params = swiper.params.zoom;\n    const zoom = swiper.zoom;\n\n    if (!support.gestures) {\n      if (!fakeGestureTouched || !fakeGestureMoved) {\n        return;\n      }\n\n      if (e.type !== 'touchend' || e.type === 'touchend' && e.changedTouches.length < 2 && !device.android) {\n        return;\n      }\n\n      fakeGestureTouched = false;\n      fakeGestureMoved = false;\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n    zoom.scale = Math.max(Math.min(zoom.scale, gesture.maxRatio), params.minRatio);\n    gesture.$imageEl.transition(swiper.params.speed).transform(`translate3d(0,0,0) scale(${zoom.scale})`);\n    currentScale = zoom.scale;\n    isScaling = false;\n    if (zoom.scale === 1) gesture.$slideEl = undefined;\n  }\n\n  function onTouchStart(e) {\n    const device = swiper.device;\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n    if (image.isTouched) return;\n    if (device.android && e.cancelable) e.preventDefault();\n    image.isTouched = true;\n    image.touchesStart.x = e.type === 'touchstart' ? e.targetTouches[0].pageX : e.pageX;\n    image.touchesStart.y = e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY;\n  }\n\n  function onTouchMove(e) {\n    const zoom = swiper.zoom;\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n    swiper.allowClick = false;\n    if (!image.isTouched || !gesture.$slideEl) return;\n\n    if (!image.isMoved) {\n      image.width = gesture.$imageEl[0].offsetWidth;\n      image.height = gesture.$imageEl[0].offsetHeight;\n      image.startX = getTranslate(gesture.$imageWrapEl[0], 'x') || 0;\n      image.startY = getTranslate(gesture.$imageWrapEl[0], 'y') || 0;\n      gesture.slideWidth = gesture.$slideEl[0].offsetWidth;\n      gesture.slideHeight = gesture.$slideEl[0].offsetHeight;\n      gesture.$imageWrapEl.transition(0);\n    } // Define if we need image drag\n\n\n    const scaledWidth = image.width * zoom.scale;\n    const scaledHeight = image.height * zoom.scale;\n    if (scaledWidth < gesture.slideWidth && scaledHeight < gesture.slideHeight) return;\n    image.minX = Math.min(gesture.slideWidth / 2 - scaledWidth / 2, 0);\n    image.maxX = -image.minX;\n    image.minY = Math.min(gesture.slideHeight / 2 - scaledHeight / 2, 0);\n    image.maxY = -image.minY;\n    image.touchesCurrent.x = e.type === 'touchmove' ? e.targetTouches[0].pageX : e.pageX;\n    image.touchesCurrent.y = e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY;\n\n    if (!image.isMoved && !isScaling) {\n      if (swiper.isHorizontal() && (Math.floor(image.minX) === Math.floor(image.startX) && image.touchesCurrent.x < image.touchesStart.x || Math.floor(image.maxX) === Math.floor(image.startX) && image.touchesCurrent.x > image.touchesStart.x)) {\n        image.isTouched = false;\n        return;\n      }\n\n      if (!swiper.isHorizontal() && (Math.floor(image.minY) === Math.floor(image.startY) && image.touchesCurrent.y < image.touchesStart.y || Math.floor(image.maxY) === Math.floor(image.startY) && image.touchesCurrent.y > image.touchesStart.y)) {\n        image.isTouched = false;\n        return;\n      }\n    }\n\n    if (e.cancelable) {\n      e.preventDefault();\n    }\n\n    e.stopPropagation();\n    image.isMoved = true;\n    image.currentX = image.touchesCurrent.x - image.touchesStart.x + image.startX;\n    image.currentY = image.touchesCurrent.y - image.touchesStart.y + image.startY;\n\n    if (image.currentX < image.minX) {\n      image.currentX = image.minX + 1 - (image.minX - image.currentX + 1) ** 0.8;\n    }\n\n    if (image.currentX > image.maxX) {\n      image.currentX = image.maxX - 1 + (image.currentX - image.maxX + 1) ** 0.8;\n    }\n\n    if (image.currentY < image.minY) {\n      image.currentY = image.minY + 1 - (image.minY - image.currentY + 1) ** 0.8;\n    }\n\n    if (image.currentY > image.maxY) {\n      image.currentY = image.maxY - 1 + (image.currentY - image.maxY + 1) ** 0.8;\n    } // Velocity\n\n\n    if (!velocity.prevPositionX) velocity.prevPositionX = image.touchesCurrent.x;\n    if (!velocity.prevPositionY) velocity.prevPositionY = image.touchesCurrent.y;\n    if (!velocity.prevTime) velocity.prevTime = Date.now();\n    velocity.x = (image.touchesCurrent.x - velocity.prevPositionX) / (Date.now() - velocity.prevTime) / 2;\n    velocity.y = (image.touchesCurrent.y - velocity.prevPositionY) / (Date.now() - velocity.prevTime) / 2;\n    if (Math.abs(image.touchesCurrent.x - velocity.prevPositionX) < 2) velocity.x = 0;\n    if (Math.abs(image.touchesCurrent.y - velocity.prevPositionY) < 2) velocity.y = 0;\n    velocity.prevPositionX = image.touchesCurrent.x;\n    velocity.prevPositionY = image.touchesCurrent.y;\n    velocity.prevTime = Date.now();\n    gesture.$imageWrapEl.transform(`translate3d(${image.currentX}px, ${image.currentY}px,0)`);\n  }\n\n  function onTouchEnd() {\n    const zoom = swiper.zoom;\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n\n    if (!image.isTouched || !image.isMoved) {\n      image.isTouched = false;\n      image.isMoved = false;\n      return;\n    }\n\n    image.isTouched = false;\n    image.isMoved = false;\n    let momentumDurationX = 300;\n    let momentumDurationY = 300;\n    const momentumDistanceX = velocity.x * momentumDurationX;\n    const newPositionX = image.currentX + momentumDistanceX;\n    const momentumDistanceY = velocity.y * momentumDurationY;\n    const newPositionY = image.currentY + momentumDistanceY; // Fix duration\n\n    if (velocity.x !== 0) momentumDurationX = Math.abs((newPositionX - image.currentX) / velocity.x);\n    if (velocity.y !== 0) momentumDurationY = Math.abs((newPositionY - image.currentY) / velocity.y);\n    const momentumDuration = Math.max(momentumDurationX, momentumDurationY);\n    image.currentX = newPositionX;\n    image.currentY = newPositionY; // Define if we need image drag\n\n    const scaledWidth = image.width * zoom.scale;\n    const scaledHeight = image.height * zoom.scale;\n    image.minX = Math.min(gesture.slideWidth / 2 - scaledWidth / 2, 0);\n    image.maxX = -image.minX;\n    image.minY = Math.min(gesture.slideHeight / 2 - scaledHeight / 2, 0);\n    image.maxY = -image.minY;\n    image.currentX = Math.max(Math.min(image.currentX, image.maxX), image.minX);\n    image.currentY = Math.max(Math.min(image.currentY, image.maxY), image.minY);\n    gesture.$imageWrapEl.transition(momentumDuration).transform(`translate3d(${image.currentX}px, ${image.currentY}px,0)`);\n  }\n\n  function onTransitionEnd() {\n    const zoom = swiper.zoom;\n\n    if (gesture.$slideEl && swiper.previousIndex !== swiper.activeIndex) {\n      if (gesture.$imageEl) {\n        gesture.$imageEl.transform('translate3d(0,0,0) scale(1)');\n      }\n\n      if (gesture.$imageWrapEl) {\n        gesture.$imageWrapEl.transform('translate3d(0,0,0)');\n      }\n\n      zoom.scale = 1;\n      currentScale = 1;\n      gesture.$slideEl = undefined;\n      gesture.$imageEl = undefined;\n      gesture.$imageWrapEl = undefined;\n    }\n  }\n\n  function zoomIn(e) {\n    const zoom = swiper.zoom;\n    const params = swiper.params.zoom;\n\n    if (!gesture.$slideEl) {\n      if (e && e.target) {\n        gesture.$slideEl = $(e.target).closest(`.${swiper.params.slideClass}`);\n      }\n\n      if (!gesture.$slideEl) {\n        if (swiper.params.virtual && swiper.params.virtual.enabled && swiper.virtual) {\n          gesture.$slideEl = swiper.$wrapperEl.children(`.${swiper.params.slideActiveClass}`);\n        } else {\n          gesture.$slideEl = swiper.slides.eq(swiper.activeIndex);\n        }\n      }\n\n      gesture.$imageEl = gesture.$slideEl.find(`.${params.containerClass}`).eq(0).find('picture, img, svg, canvas, .swiper-zoom-target').eq(0);\n      gesture.$imageWrapEl = gesture.$imageEl.parent(`.${params.containerClass}`);\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0 || !gesture.$imageWrapEl || gesture.$imageWrapEl.length === 0) return;\n\n    if (swiper.params.cssMode) {\n      swiper.wrapperEl.style.overflow = 'hidden';\n      swiper.wrapperEl.style.touchAction = 'none';\n    }\n\n    gesture.$slideEl.addClass(`${params.zoomedSlideClass}`);\n    let touchX;\n    let touchY;\n    let offsetX;\n    let offsetY;\n    let diffX;\n    let diffY;\n    let translateX;\n    let translateY;\n    let imageWidth;\n    let imageHeight;\n    let scaledWidth;\n    let scaledHeight;\n    let translateMinX;\n    let translateMinY;\n    let translateMaxX;\n    let translateMaxY;\n    let slideWidth;\n    let slideHeight;\n\n    if (typeof image.touchesStart.x === 'undefined' && e) {\n      touchX = e.type === 'touchend' ? e.changedTouches[0].pageX : e.pageX;\n      touchY = e.type === 'touchend' ? e.changedTouches[0].pageY : e.pageY;\n    } else {\n      touchX = image.touchesStart.x;\n      touchY = image.touchesStart.y;\n    }\n\n    zoom.scale = gesture.$imageWrapEl.attr('data-swiper-zoom') || params.maxRatio;\n    currentScale = gesture.$imageWrapEl.attr('data-swiper-zoom') || params.maxRatio;\n\n    if (e) {\n      slideWidth = gesture.$slideEl[0].offsetWidth;\n      slideHeight = gesture.$slideEl[0].offsetHeight;\n      offsetX = gesture.$slideEl.offset().left + window.scrollX;\n      offsetY = gesture.$slideEl.offset().top + window.scrollY;\n      diffX = offsetX + slideWidth / 2 - touchX;\n      diffY = offsetY + slideHeight / 2 - touchY;\n      imageWidth = gesture.$imageEl[0].offsetWidth;\n      imageHeight = gesture.$imageEl[0].offsetHeight;\n      scaledWidth = imageWidth * zoom.scale;\n      scaledHeight = imageHeight * zoom.scale;\n      translateMinX = Math.min(slideWidth / 2 - scaledWidth / 2, 0);\n      translateMinY = Math.min(slideHeight / 2 - scaledHeight / 2, 0);\n      translateMaxX = -translateMinX;\n      translateMaxY = -translateMinY;\n      translateX = diffX * zoom.scale;\n      translateY = diffY * zoom.scale;\n\n      if (translateX < translateMinX) {\n        translateX = translateMinX;\n      }\n\n      if (translateX > translateMaxX) {\n        translateX = translateMaxX;\n      }\n\n      if (translateY < translateMinY) {\n        translateY = translateMinY;\n      }\n\n      if (translateY > translateMaxY) {\n        translateY = translateMaxY;\n      }\n    } else {\n      translateX = 0;\n      translateY = 0;\n    }\n\n    gesture.$imageWrapEl.transition(300).transform(`translate3d(${translateX}px, ${translateY}px,0)`);\n    gesture.$imageEl.transition(300).transform(`translate3d(0,0,0) scale(${zoom.scale})`);\n  }\n\n  function zoomOut() {\n    const zoom = swiper.zoom;\n    const params = swiper.params.zoom;\n\n    if (!gesture.$slideEl) {\n      if (swiper.params.virtual && swiper.params.virtual.enabled && swiper.virtual) {\n        gesture.$slideEl = swiper.$wrapperEl.children(`.${swiper.params.slideActiveClass}`);\n      } else {\n        gesture.$slideEl = swiper.slides.eq(swiper.activeIndex);\n      }\n\n      gesture.$imageEl = gesture.$slideEl.find(`.${params.containerClass}`).eq(0).find('picture, img, svg, canvas, .swiper-zoom-target').eq(0);\n      gesture.$imageWrapEl = gesture.$imageEl.parent(`.${params.containerClass}`);\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0 || !gesture.$imageWrapEl || gesture.$imageWrapEl.length === 0) return;\n\n    if (swiper.params.cssMode) {\n      swiper.wrapperEl.style.overflow = '';\n      swiper.wrapperEl.style.touchAction = '';\n    }\n\n    zoom.scale = 1;\n    currentScale = 1;\n    gesture.$imageWrapEl.transition(300).transform('translate3d(0,0,0)');\n    gesture.$imageEl.transition(300).transform('translate3d(0,0,0) scale(1)');\n    gesture.$slideEl.removeClass(`${params.zoomedSlideClass}`);\n    gesture.$slideEl = undefined;\n  } // Toggle Zoom\n\n\n  function zoomToggle(e) {\n    const zoom = swiper.zoom;\n\n    if (zoom.scale && zoom.scale !== 1) {\n      // Zoom Out\n      zoomOut();\n    } else {\n      // Zoom In\n      zoomIn(e);\n    }\n  }\n\n  function getListeners() {\n    const support = swiper.support;\n    const passiveListener = swiper.touchEvents.start === 'touchstart' && support.passiveListener && swiper.params.passiveListeners ? {\n      passive: true,\n      capture: false\n    } : false;\n    const activeListenerWithCapture = support.passiveListener ? {\n      passive: false,\n      capture: true\n    } : true;\n    return {\n      passiveListener,\n      activeListenerWithCapture\n    };\n  }\n\n  function getSlideSelector() {\n    return `.${swiper.params.slideClass}`;\n  }\n\n  function toggleGestures(method) {\n    const {\n      passiveListener\n    } = getListeners();\n    const slideSelector = getSlideSelector();\n    swiper.$wrapperEl[method]('gesturestart', slideSelector, onGestureStart, passiveListener);\n    swiper.$wrapperEl[method]('gesturechange', slideSelector, onGestureChange, passiveListener);\n    swiper.$wrapperEl[method]('gestureend', slideSelector, onGestureEnd, passiveListener);\n  }\n\n  function enableGestures() {\n    if (gesturesEnabled) return;\n    gesturesEnabled = true;\n    toggleGestures('on');\n  }\n\n  function disableGestures() {\n    if (!gesturesEnabled) return;\n    gesturesEnabled = false;\n    toggleGestures('off');\n  } // Attach/Detach Events\n\n\n  function enable() {\n    const zoom = swiper.zoom;\n    if (zoom.enabled) return;\n    zoom.enabled = true;\n    const support = swiper.support;\n    const {\n      passiveListener,\n      activeListenerWithCapture\n    } = getListeners();\n    const slideSelector = getSlideSelector(); // Scale image\n\n    if (support.gestures) {\n      swiper.$wrapperEl.on(swiper.touchEvents.start, enableGestures, passiveListener);\n      swiper.$wrapperEl.on(swiper.touchEvents.end, disableGestures, passiveListener);\n    } else if (swiper.touchEvents.start === 'touchstart') {\n      swiper.$wrapperEl.on(swiper.touchEvents.start, slideSelector, onGestureStart, passiveListener);\n      swiper.$wrapperEl.on(swiper.touchEvents.move, slideSelector, onGestureChange, activeListenerWithCapture);\n      swiper.$wrapperEl.on(swiper.touchEvents.end, slideSelector, onGestureEnd, passiveListener);\n\n      if (swiper.touchEvents.cancel) {\n        swiper.$wrapperEl.on(swiper.touchEvents.cancel, slideSelector, onGestureEnd, passiveListener);\n      }\n    } // Move image\n\n\n    swiper.$wrapperEl.on(swiper.touchEvents.move, `.${swiper.params.zoom.containerClass}`, onTouchMove, activeListenerWithCapture);\n  }\n\n  function disable() {\n    const zoom = swiper.zoom;\n    if (!zoom.enabled) return;\n    const support = swiper.support;\n    zoom.enabled = false;\n    const {\n      passiveListener,\n      activeListenerWithCapture\n    } = getListeners();\n    const slideSelector = getSlideSelector(); // Scale image\n\n    if (support.gestures) {\n      swiper.$wrapperEl.off(swiper.touchEvents.start, enableGestures, passiveListener);\n      swiper.$wrapperEl.off(swiper.touchEvents.end, disableGestures, passiveListener);\n    } else if (swiper.touchEvents.start === 'touchstart') {\n      swiper.$wrapperEl.off(swiper.touchEvents.start, slideSelector, onGestureStart, passiveListener);\n      swiper.$wrapperEl.off(swiper.touchEvents.move, slideSelector, onGestureChange, activeListenerWithCapture);\n      swiper.$wrapperEl.off(swiper.touchEvents.end, slideSelector, onGestureEnd, passiveListener);\n\n      if (swiper.touchEvents.cancel) {\n        swiper.$wrapperEl.off(swiper.touchEvents.cancel, slideSelector, onGestureEnd, passiveListener);\n      }\n    } // Move image\n\n\n    swiper.$wrapperEl.off(swiper.touchEvents.move, `.${swiper.params.zoom.containerClass}`, onTouchMove, activeListenerWithCapture);\n  }\n\n  on('init', () => {\n    if (swiper.params.zoom.enabled) {\n      enable();\n    }\n  });\n  on('destroy', () => {\n    disable();\n  });\n  on('touchStart', (_s, e) => {\n    if (!swiper.zoom.enabled) return;\n    onTouchStart(e);\n  });\n  on('touchEnd', (_s, e) => {\n    if (!swiper.zoom.enabled) return;\n    onTouchEnd(e);\n  });\n  on('doubleTap', (_s, e) => {\n    if (!swiper.animating && swiper.params.zoom.enabled && swiper.zoom.enabled && swiper.params.zoom.toggle) {\n      zoomToggle(e);\n    }\n  });\n  on('transitionEnd', () => {\n    if (swiper.zoom.enabled && swiper.params.zoom.enabled) {\n      onTransitionEnd();\n    }\n  });\n  on('slideChange', () => {\n    if (swiper.zoom.enabled && swiper.params.zoom.enabled && swiper.params.cssMode) {\n      onTransitionEnd();\n    }\n  });\n  Object.assign(swiper.zoom, {\n    enable,\n    disable,\n    in: zoomIn,\n    out: zoomOut,\n    toggle: zoomToggle\n  });\n}","map":{"version":3,"sources":["/Users/hxt365/GolandProjects/cloud-gaming/web/node_modules/swiper/modules/zoom/zoom.js"],"names":["getWindow","$","getTranslate","Zoom","_ref","swiper","extendParams","on","emit","window","zoom","enabled","maxRatio","minRatio","toggle","containerClass","zoomedSlideClass","currentScale","isScaling","gesturesEnabled","fakeGestureTouched","fakeGestureMoved","gesture","$slideEl","undefined","slideWidth","slideHeight","$imageEl","$imageWrapEl","image","isTouched","isMoved","currentX","currentY","minX","minY","maxX","maxY","width","height","startX","startY","touchesStart","touchesCurrent","velocity","x","y","prevPositionX","prevPositionY","prevTime","scale","Object","defineProperty","get","set","value","imageEl","slideEl","getDistanceBetweenTouches","e","targetTouches","length","x1","pageX","y1","pageY","x2","y2","distance","Math","sqrt","onGestureStart","support","params","gestures","type","scaleStart","target","closest","slideClass","slides","eq","activeIndex","find","parent","attr","transition","onGestureChange","scaleMove","transform","onGestureEnd","device","changedTouches","android","max","min","speed","onTouchStart","cancelable","preventDefault","onTouchMove","allowClick","offsetWidth","offsetHeight","scaledWidth","scaledHeight","isHorizontal","floor","stopPropagation","Date","now","abs","onTouchEnd","momentumDurationX","momentumDurationY","momentumDistanceX","newPositionX","momentumDistanceY","newPositionY","momentumDuration","onTransitionEnd","previousIndex","zoomIn","virtual","$wrapperEl","children","slideActiveClass","cssMode","wrapperEl","style","overflow","touchAction","addClass","touchX","touchY","offsetX","offsetY","diffX","diffY","translateX","translateY","imageWidth","imageHeight","translateMinX","translateMinY","translateMaxX","translateMaxY","offset","left","scrollX","top","scrollY","zoomOut","removeClass","zoomToggle","getListeners","passiveListener","touchEvents","start","passiveListeners","passive","capture","activeListenerWithCapture","getSlideSelector","toggleGestures","method","slideSelector","enableGestures","disableGestures","enable","end","move","cancel","disable","off","_s","animating","assign","in","out"],"mappings":"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","sourcesContent":["import { getWindow } from 'ssr-window';\nimport $ from '../../shared/dom.js';\nimport { getTranslate } from '../../shared/utils.js';\nexport default function Zoom(_ref) {\n  let {\n    swiper,\n    extendParams,\n    on,\n    emit\n  } = _ref;\n  const window = getWindow();\n  extendParams({\n    zoom: {\n      enabled: false,\n      maxRatio: 3,\n      minRatio: 1,\n      toggle: true,\n      containerClass: 'swiper-zoom-container',\n      zoomedSlideClass: 'swiper-slide-zoomed'\n    }\n  });\n  swiper.zoom = {\n    enabled: false\n  };\n  let currentScale = 1;\n  let isScaling = false;\n  let gesturesEnabled;\n  let fakeGestureTouched;\n  let fakeGestureMoved;\n  const gesture = {\n    $slideEl: undefined,\n    slideWidth: undefined,\n    slideHeight: undefined,\n    $imageEl: undefined,\n    $imageWrapEl: undefined,\n    maxRatio: 3\n  };\n  const image = {\n    isTouched: undefined,\n    isMoved: undefined,\n    currentX: undefined,\n    currentY: undefined,\n    minX: undefined,\n    minY: undefined,\n    maxX: undefined,\n    maxY: undefined,\n    width: undefined,\n    height: undefined,\n    startX: undefined,\n    startY: undefined,\n    touchesStart: {},\n    touchesCurrent: {}\n  };\n  const velocity = {\n    x: undefined,\n    y: undefined,\n    prevPositionX: undefined,\n    prevPositionY: undefined,\n    prevTime: undefined\n  };\n  let scale = 1;\n  Object.defineProperty(swiper.zoom, 'scale', {\n    get() {\n      return scale;\n    },\n\n    set(value) {\n      if (scale !== value) {\n        const imageEl = gesture.$imageEl ? gesture.$imageEl[0] : undefined;\n        const slideEl = gesture.$slideEl ? gesture.$slideEl[0] : undefined;\n        emit('zoomChange', value, imageEl, slideEl);\n      }\n\n      scale = value;\n    }\n\n  });\n\n  function getDistanceBetweenTouches(e) {\n    if (e.targetTouches.length < 2) return 1;\n    const x1 = e.targetTouches[0].pageX;\n    const y1 = e.targetTouches[0].pageY;\n    const x2 = e.targetTouches[1].pageX;\n    const y2 = e.targetTouches[1].pageY;\n    const distance = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n    return distance;\n  } // Events\n\n\n  function onGestureStart(e) {\n    const support = swiper.support;\n    const params = swiper.params.zoom;\n    fakeGestureTouched = false;\n    fakeGestureMoved = false;\n\n    if (!support.gestures) {\n      if (e.type !== 'touchstart' || e.type === 'touchstart' && e.targetTouches.length < 2) {\n        return;\n      }\n\n      fakeGestureTouched = true;\n      gesture.scaleStart = getDistanceBetweenTouches(e);\n    }\n\n    if (!gesture.$slideEl || !gesture.$slideEl.length) {\n      gesture.$slideEl = $(e.target).closest(`.${swiper.params.slideClass}`);\n      if (gesture.$slideEl.length === 0) gesture.$slideEl = swiper.slides.eq(swiper.activeIndex);\n      gesture.$imageEl = gesture.$slideEl.find(`.${params.containerClass}`).eq(0).find('picture, img, svg, canvas, .swiper-zoom-target').eq(0);\n      gesture.$imageWrapEl = gesture.$imageEl.parent(`.${params.containerClass}`);\n      gesture.maxRatio = gesture.$imageWrapEl.attr('data-swiper-zoom') || params.maxRatio;\n\n      if (gesture.$imageWrapEl.length === 0) {\n        gesture.$imageEl = undefined;\n        return;\n      }\n    }\n\n    if (gesture.$imageEl) {\n      gesture.$imageEl.transition(0);\n    }\n\n    isScaling = true;\n  }\n\n  function onGestureChange(e) {\n    const support = swiper.support;\n    const params = swiper.params.zoom;\n    const zoom = swiper.zoom;\n\n    if (!support.gestures) {\n      if (e.type !== 'touchmove' || e.type === 'touchmove' && e.targetTouches.length < 2) {\n        return;\n      }\n\n      fakeGestureMoved = true;\n      gesture.scaleMove = getDistanceBetweenTouches(e);\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) {\n      if (e.type === 'gesturechange') onGestureStart(e);\n      return;\n    }\n\n    if (support.gestures) {\n      zoom.scale = e.scale * currentScale;\n    } else {\n      zoom.scale = gesture.scaleMove / gesture.scaleStart * currentScale;\n    }\n\n    if (zoom.scale > gesture.maxRatio) {\n      zoom.scale = gesture.maxRatio - 1 + (zoom.scale - gesture.maxRatio + 1) ** 0.5;\n    }\n\n    if (zoom.scale < params.minRatio) {\n      zoom.scale = params.minRatio + 1 - (params.minRatio - zoom.scale + 1) ** 0.5;\n    }\n\n    gesture.$imageEl.transform(`translate3d(0,0,0) scale(${zoom.scale})`);\n  }\n\n  function onGestureEnd(e) {\n    const device = swiper.device;\n    const support = swiper.support;\n    const params = swiper.params.zoom;\n    const zoom = swiper.zoom;\n\n    if (!support.gestures) {\n      if (!fakeGestureTouched || !fakeGestureMoved) {\n        return;\n      }\n\n      if (e.type !== 'touchend' || e.type === 'touchend' && e.changedTouches.length < 2 && !device.android) {\n        return;\n      }\n\n      fakeGestureTouched = false;\n      fakeGestureMoved = false;\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n    zoom.scale = Math.max(Math.min(zoom.scale, gesture.maxRatio), params.minRatio);\n    gesture.$imageEl.transition(swiper.params.speed).transform(`translate3d(0,0,0) scale(${zoom.scale})`);\n    currentScale = zoom.scale;\n    isScaling = false;\n    if (zoom.scale === 1) gesture.$slideEl = undefined;\n  }\n\n  function onTouchStart(e) {\n    const device = swiper.device;\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n    if (image.isTouched) return;\n    if (device.android && e.cancelable) e.preventDefault();\n    image.isTouched = true;\n    image.touchesStart.x = e.type === 'touchstart' ? e.targetTouches[0].pageX : e.pageX;\n    image.touchesStart.y = e.type === 'touchstart' ? e.targetTouches[0].pageY : e.pageY;\n  }\n\n  function onTouchMove(e) {\n    const zoom = swiper.zoom;\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n    swiper.allowClick = false;\n    if (!image.isTouched || !gesture.$slideEl) return;\n\n    if (!image.isMoved) {\n      image.width = gesture.$imageEl[0].offsetWidth;\n      image.height = gesture.$imageEl[0].offsetHeight;\n      image.startX = getTranslate(gesture.$imageWrapEl[0], 'x') || 0;\n      image.startY = getTranslate(gesture.$imageWrapEl[0], 'y') || 0;\n      gesture.slideWidth = gesture.$slideEl[0].offsetWidth;\n      gesture.slideHeight = gesture.$slideEl[0].offsetHeight;\n      gesture.$imageWrapEl.transition(0);\n    } // Define if we need image drag\n\n\n    const scaledWidth = image.width * zoom.scale;\n    const scaledHeight = image.height * zoom.scale;\n    if (scaledWidth < gesture.slideWidth && scaledHeight < gesture.slideHeight) return;\n    image.minX = Math.min(gesture.slideWidth / 2 - scaledWidth / 2, 0);\n    image.maxX = -image.minX;\n    image.minY = Math.min(gesture.slideHeight / 2 - scaledHeight / 2, 0);\n    image.maxY = -image.minY;\n    image.touchesCurrent.x = e.type === 'touchmove' ? e.targetTouches[0].pageX : e.pageX;\n    image.touchesCurrent.y = e.type === 'touchmove' ? e.targetTouches[0].pageY : e.pageY;\n\n    if (!image.isMoved && !isScaling) {\n      if (swiper.isHorizontal() && (Math.floor(image.minX) === Math.floor(image.startX) && image.touchesCurrent.x < image.touchesStart.x || Math.floor(image.maxX) === Math.floor(image.startX) && image.touchesCurrent.x > image.touchesStart.x)) {\n        image.isTouched = false;\n        return;\n      }\n\n      if (!swiper.isHorizontal() && (Math.floor(image.minY) === Math.floor(image.startY) && image.touchesCurrent.y < image.touchesStart.y || Math.floor(image.maxY) === Math.floor(image.startY) && image.touchesCurrent.y > image.touchesStart.y)) {\n        image.isTouched = false;\n        return;\n      }\n    }\n\n    if (e.cancelable) {\n      e.preventDefault();\n    }\n\n    e.stopPropagation();\n    image.isMoved = true;\n    image.currentX = image.touchesCurrent.x - image.touchesStart.x + image.startX;\n    image.currentY = image.touchesCurrent.y - image.touchesStart.y + image.startY;\n\n    if (image.currentX < image.minX) {\n      image.currentX = image.minX + 1 - (image.minX - image.currentX + 1) ** 0.8;\n    }\n\n    if (image.currentX > image.maxX) {\n      image.currentX = image.maxX - 1 + (image.currentX - image.maxX + 1) ** 0.8;\n    }\n\n    if (image.currentY < image.minY) {\n      image.currentY = image.minY + 1 - (image.minY - image.currentY + 1) ** 0.8;\n    }\n\n    if (image.currentY > image.maxY) {\n      image.currentY = image.maxY - 1 + (image.currentY - image.maxY + 1) ** 0.8;\n    } // Velocity\n\n\n    if (!velocity.prevPositionX) velocity.prevPositionX = image.touchesCurrent.x;\n    if (!velocity.prevPositionY) velocity.prevPositionY = image.touchesCurrent.y;\n    if (!velocity.prevTime) velocity.prevTime = Date.now();\n    velocity.x = (image.touchesCurrent.x - velocity.prevPositionX) / (Date.now() - velocity.prevTime) / 2;\n    velocity.y = (image.touchesCurrent.y - velocity.prevPositionY) / (Date.now() - velocity.prevTime) / 2;\n    if (Math.abs(image.touchesCurrent.x - velocity.prevPositionX) < 2) velocity.x = 0;\n    if (Math.abs(image.touchesCurrent.y - velocity.prevPositionY) < 2) velocity.y = 0;\n    velocity.prevPositionX = image.touchesCurrent.x;\n    velocity.prevPositionY = image.touchesCurrent.y;\n    velocity.prevTime = Date.now();\n    gesture.$imageWrapEl.transform(`translate3d(${image.currentX}px, ${image.currentY}px,0)`);\n  }\n\n  function onTouchEnd() {\n    const zoom = swiper.zoom;\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0) return;\n\n    if (!image.isTouched || !image.isMoved) {\n      image.isTouched = false;\n      image.isMoved = false;\n      return;\n    }\n\n    image.isTouched = false;\n    image.isMoved = false;\n    let momentumDurationX = 300;\n    let momentumDurationY = 300;\n    const momentumDistanceX = velocity.x * momentumDurationX;\n    const newPositionX = image.currentX + momentumDistanceX;\n    const momentumDistanceY = velocity.y * momentumDurationY;\n    const newPositionY = image.currentY + momentumDistanceY; // Fix duration\n\n    if (velocity.x !== 0) momentumDurationX = Math.abs((newPositionX - image.currentX) / velocity.x);\n    if (velocity.y !== 0) momentumDurationY = Math.abs((newPositionY - image.currentY) / velocity.y);\n    const momentumDuration = Math.max(momentumDurationX, momentumDurationY);\n    image.currentX = newPositionX;\n    image.currentY = newPositionY; // Define if we need image drag\n\n    const scaledWidth = image.width * zoom.scale;\n    const scaledHeight = image.height * zoom.scale;\n    image.minX = Math.min(gesture.slideWidth / 2 - scaledWidth / 2, 0);\n    image.maxX = -image.minX;\n    image.minY = Math.min(gesture.slideHeight / 2 - scaledHeight / 2, 0);\n    image.maxY = -image.minY;\n    image.currentX = Math.max(Math.min(image.currentX, image.maxX), image.minX);\n    image.currentY = Math.max(Math.min(image.currentY, image.maxY), image.minY);\n    gesture.$imageWrapEl.transition(momentumDuration).transform(`translate3d(${image.currentX}px, ${image.currentY}px,0)`);\n  }\n\n  function onTransitionEnd() {\n    const zoom = swiper.zoom;\n\n    if (gesture.$slideEl && swiper.previousIndex !== swiper.activeIndex) {\n      if (gesture.$imageEl) {\n        gesture.$imageEl.transform('translate3d(0,0,0) scale(1)');\n      }\n\n      if (gesture.$imageWrapEl) {\n        gesture.$imageWrapEl.transform('translate3d(0,0,0)');\n      }\n\n      zoom.scale = 1;\n      currentScale = 1;\n      gesture.$slideEl = undefined;\n      gesture.$imageEl = undefined;\n      gesture.$imageWrapEl = undefined;\n    }\n  }\n\n  function zoomIn(e) {\n    const zoom = swiper.zoom;\n    const params = swiper.params.zoom;\n\n    if (!gesture.$slideEl) {\n      if (e && e.target) {\n        gesture.$slideEl = $(e.target).closest(`.${swiper.params.slideClass}`);\n      }\n\n      if (!gesture.$slideEl) {\n        if (swiper.params.virtual && swiper.params.virtual.enabled && swiper.virtual) {\n          gesture.$slideEl = swiper.$wrapperEl.children(`.${swiper.params.slideActiveClass}`);\n        } else {\n          gesture.$slideEl = swiper.slides.eq(swiper.activeIndex);\n        }\n      }\n\n      gesture.$imageEl = gesture.$slideEl.find(`.${params.containerClass}`).eq(0).find('picture, img, svg, canvas, .swiper-zoom-target').eq(0);\n      gesture.$imageWrapEl = gesture.$imageEl.parent(`.${params.containerClass}`);\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0 || !gesture.$imageWrapEl || gesture.$imageWrapEl.length === 0) return;\n\n    if (swiper.params.cssMode) {\n      swiper.wrapperEl.style.overflow = 'hidden';\n      swiper.wrapperEl.style.touchAction = 'none';\n    }\n\n    gesture.$slideEl.addClass(`${params.zoomedSlideClass}`);\n    let touchX;\n    let touchY;\n    let offsetX;\n    let offsetY;\n    let diffX;\n    let diffY;\n    let translateX;\n    let translateY;\n    let imageWidth;\n    let imageHeight;\n    let scaledWidth;\n    let scaledHeight;\n    let translateMinX;\n    let translateMinY;\n    let translateMaxX;\n    let translateMaxY;\n    let slideWidth;\n    let slideHeight;\n\n    if (typeof image.touchesStart.x === 'undefined' && e) {\n      touchX = e.type === 'touchend' ? e.changedTouches[0].pageX : e.pageX;\n      touchY = e.type === 'touchend' ? e.changedTouches[0].pageY : e.pageY;\n    } else {\n      touchX = image.touchesStart.x;\n      touchY = image.touchesStart.y;\n    }\n\n    zoom.scale = gesture.$imageWrapEl.attr('data-swiper-zoom') || params.maxRatio;\n    currentScale = gesture.$imageWrapEl.attr('data-swiper-zoom') || params.maxRatio;\n\n    if (e) {\n      slideWidth = gesture.$slideEl[0].offsetWidth;\n      slideHeight = gesture.$slideEl[0].offsetHeight;\n      offsetX = gesture.$slideEl.offset().left + window.scrollX;\n      offsetY = gesture.$slideEl.offset().top + window.scrollY;\n      diffX = offsetX + slideWidth / 2 - touchX;\n      diffY = offsetY + slideHeight / 2 - touchY;\n      imageWidth = gesture.$imageEl[0].offsetWidth;\n      imageHeight = gesture.$imageEl[0].offsetHeight;\n      scaledWidth = imageWidth * zoom.scale;\n      scaledHeight = imageHeight * zoom.scale;\n      translateMinX = Math.min(slideWidth / 2 - scaledWidth / 2, 0);\n      translateMinY = Math.min(slideHeight / 2 - scaledHeight / 2, 0);\n      translateMaxX = -translateMinX;\n      translateMaxY = -translateMinY;\n      translateX = diffX * zoom.scale;\n      translateY = diffY * zoom.scale;\n\n      if (translateX < translateMinX) {\n        translateX = translateMinX;\n      }\n\n      if (translateX > translateMaxX) {\n        translateX = translateMaxX;\n      }\n\n      if (translateY < translateMinY) {\n        translateY = translateMinY;\n      }\n\n      if (translateY > translateMaxY) {\n        translateY = translateMaxY;\n      }\n    } else {\n      translateX = 0;\n      translateY = 0;\n    }\n\n    gesture.$imageWrapEl.transition(300).transform(`translate3d(${translateX}px, ${translateY}px,0)`);\n    gesture.$imageEl.transition(300).transform(`translate3d(0,0,0) scale(${zoom.scale})`);\n  }\n\n  function zoomOut() {\n    const zoom = swiper.zoom;\n    const params = swiper.params.zoom;\n\n    if (!gesture.$slideEl) {\n      if (swiper.params.virtual && swiper.params.virtual.enabled && swiper.virtual) {\n        gesture.$slideEl = swiper.$wrapperEl.children(`.${swiper.params.slideActiveClass}`);\n      } else {\n        gesture.$slideEl = swiper.slides.eq(swiper.activeIndex);\n      }\n\n      gesture.$imageEl = gesture.$slideEl.find(`.${params.containerClass}`).eq(0).find('picture, img, svg, canvas, .swiper-zoom-target').eq(0);\n      gesture.$imageWrapEl = gesture.$imageEl.parent(`.${params.containerClass}`);\n    }\n\n    if (!gesture.$imageEl || gesture.$imageEl.length === 0 || !gesture.$imageWrapEl || gesture.$imageWrapEl.length === 0) return;\n\n    if (swiper.params.cssMode) {\n      swiper.wrapperEl.style.overflow = '';\n      swiper.wrapperEl.style.touchAction = '';\n    }\n\n    zoom.scale = 1;\n    currentScale = 1;\n    gesture.$imageWrapEl.transition(300).transform('translate3d(0,0,0)');\n    gesture.$imageEl.transition(300).transform('translate3d(0,0,0) scale(1)');\n    gesture.$slideEl.removeClass(`${params.zoomedSlideClass}`);\n    gesture.$slideEl = undefined;\n  } // Toggle Zoom\n\n\n  function zoomToggle(e) {\n    const zoom = swiper.zoom;\n\n    if (zoom.scale && zoom.scale !== 1) {\n      // Zoom Out\n      zoomOut();\n    } else {\n      // Zoom In\n      zoomIn(e);\n    }\n  }\n\n  function getListeners() {\n    const support = swiper.support;\n    const passiveListener = swiper.touchEvents.start === 'touchstart' && support.passiveListener && swiper.params.passiveListeners ? {\n      passive: true,\n      capture: false\n    } : false;\n    const activeListenerWithCapture = support.passiveListener ? {\n      passive: false,\n      capture: true\n    } : true;\n    return {\n      passiveListener,\n      activeListenerWithCapture\n    };\n  }\n\n  function getSlideSelector() {\n    return `.${swiper.params.slideClass}`;\n  }\n\n  function toggleGestures(method) {\n    const {\n      passiveListener\n    } = getListeners();\n    const slideSelector = getSlideSelector();\n    swiper.$wrapperEl[method]('gesturestart', slideSelector, onGestureStart, passiveListener);\n    swiper.$wrapperEl[method]('gesturechange', slideSelector, onGestureChange, passiveListener);\n    swiper.$wrapperEl[method]('gestureend', slideSelector, onGestureEnd, passiveListener);\n  }\n\n  function enableGestures() {\n    if (gesturesEnabled) return;\n    gesturesEnabled = true;\n    toggleGestures('on');\n  }\n\n  function disableGestures() {\n    if (!gesturesEnabled) return;\n    gesturesEnabled = false;\n    toggleGestures('off');\n  } // Attach/Detach Events\n\n\n  function enable() {\n    const zoom = swiper.zoom;\n    if (zoom.enabled) return;\n    zoom.enabled = true;\n    const support = swiper.support;\n    const {\n      passiveListener,\n      activeListenerWithCapture\n    } = getListeners();\n    const slideSelector = getSlideSelector(); // Scale image\n\n    if (support.gestures) {\n      swiper.$wrapperEl.on(swiper.touchEvents.start, enableGestures, passiveListener);\n      swiper.$wrapperEl.on(swiper.touchEvents.end, disableGestures, passiveListener);\n    } else if (swiper.touchEvents.start === 'touchstart') {\n      swiper.$wrapperEl.on(swiper.touchEvents.start, slideSelector, onGestureStart, passiveListener);\n      swiper.$wrapperEl.on(swiper.touchEvents.move, slideSelector, onGestureChange, activeListenerWithCapture);\n      swiper.$wrapperEl.on(swiper.touchEvents.end, slideSelector, onGestureEnd, passiveListener);\n\n      if (swiper.touchEvents.cancel) {\n        swiper.$wrapperEl.on(swiper.touchEvents.cancel, slideSelector, onGestureEnd, passiveListener);\n      }\n    } // Move image\n\n\n    swiper.$wrapperEl.on(swiper.touchEvents.move, `.${swiper.params.zoom.containerClass}`, onTouchMove, activeListenerWithCapture);\n  }\n\n  function disable() {\n    const zoom = swiper.zoom;\n    if (!zoom.enabled) return;\n    const support = swiper.support;\n    zoom.enabled = false;\n    const {\n      passiveListener,\n      activeListenerWithCapture\n    } = getListeners();\n    const slideSelector = getSlideSelector(); // Scale image\n\n    if (support.gestures) {\n      swiper.$wrapperEl.off(swiper.touchEvents.start, enableGestures, passiveListener);\n      swiper.$wrapperEl.off(swiper.touchEvents.end, disableGestures, passiveListener);\n    } else if (swiper.touchEvents.start === 'touchstart') {\n      swiper.$wrapperEl.off(swiper.touchEvents.start, slideSelector, onGestureStart, passiveListener);\n      swiper.$wrapperEl.off(swiper.touchEvents.move, slideSelector, onGestureChange, activeListenerWithCapture);\n      swiper.$wrapperEl.off(swiper.touchEvents.end, slideSelector, onGestureEnd, passiveListener);\n\n      if (swiper.touchEvents.cancel) {\n        swiper.$wrapperEl.off(swiper.touchEvents.cancel, slideSelector, onGestureEnd, passiveListener);\n      }\n    } // Move image\n\n\n    swiper.$wrapperEl.off(swiper.touchEvents.move, `.${swiper.params.zoom.containerClass}`, onTouchMove, activeListenerWithCapture);\n  }\n\n  on('init', () => {\n    if (swiper.params.zoom.enabled) {\n      enable();\n    }\n  });\n  on('destroy', () => {\n    disable();\n  });\n  on('touchStart', (_s, e) => {\n    if (!swiper.zoom.enabled) return;\n    onTouchStart(e);\n  });\n  on('touchEnd', (_s, e) => {\n    if (!swiper.zoom.enabled) return;\n    onTouchEnd(e);\n  });\n  on('doubleTap', (_s, e) => {\n    if (!swiper.animating && swiper.params.zoom.enabled && swiper.zoom.enabled && swiper.params.zoom.toggle) {\n      zoomToggle(e);\n    }\n  });\n  on('transitionEnd', () => {\n    if (swiper.zoom.enabled && swiper.params.zoom.enabled) {\n      onTransitionEnd();\n    }\n  });\n  on('slideChange', () => {\n    if (swiper.zoom.enabled && swiper.params.zoom.enabled && swiper.params.cssMode) {\n      onTransitionEnd();\n    }\n  });\n  Object.assign(swiper.zoom, {\n    enable,\n    disable,\n    in: zoomIn,\n    out: zoomOut,\n    toggle: zoomToggle\n  });\n}"]},"metadata":{},"sourceType":"module"}